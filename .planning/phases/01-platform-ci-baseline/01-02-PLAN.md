---
phase: 01-platform-ci-baseline
plan: 02
type: execute
wave: 2
depends_on:
  - "01-01"
files_modified:
  - ui/package.json
  - ui/.eslintrc.cjs
  - ui/vite.config.ts
  - Dockerfile
  - justfile
  - Makefile
autonomous: true
must_haves:
  truths:
    - "Maintainer can run lint and tests locally using npm/justfile."
    - "Maintainer can build the extension image using Vite output."
  artifacts:
    - path: "justfile"
      provides: "Local dev/build/test targets for UI + VM"
  key_links:
    - from: "Dockerfile"
      to: "ui/dist"
      via: "COPY --from=client-builder"
      pattern: "dist"
---

<objective>
Add lint/test tooling plus justfile tasks and update Docker build for Vite.

Purpose: Satisfy PLAT-03 with local lint/tests and Vite-compatible Docker builds.
Output: Updated tooling scripts, justfile targets, and Dockerfile changes.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-platform-ci-baseline/01-RESEARCH.md
@ui/package.json
@ui/vite.config.ts
@Dockerfile
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add lint and test tooling for Vite</name>
  <files>ui/package.json, ui/.eslintrc.cjs, ui/vite.config.ts</files>
  <action>
    - Add ESLint + React config (eslint, eslint-config-react-app, eslint-plugin-react, eslint-plugin-react-hooks, eslint-plugin-testing-library, eslint-plugin-jest).
    - Add Vitest + jsdom dependencies and configure `test` block in `ui/vite.config.ts`.
    - Add `ui/.eslintrc.cjs` extending `react-app` and `react-app/jest` to preserve CRA lint behavior.
    - Update `ui/package.json` scripts to include `lint` and `test` entries.
  </action>
  <verify>npm --prefix ui run lint && npm --prefix ui run test -- --run</verify>
  <done>`npm run lint` and `npm run test` run without CRA tooling.</done>
</task>

<task type="auto">
  <name>Task 2: Add justfile and update Docker build stage</name>
  <files>justfile, Makefile, Dockerfile</files>
  <action>
    - Create a `justfile` with targets for UI dev/build/test/lint, VM test/vet, docker build, extension validate, and install/update.
    - Convert `Makefile` to a thin wrapper that forwards to `just` (or prints a deprecation note with equivalent commands).
    - Update `Dockerfile` UI build stage to Node 20.19+ and copy `ui/dist` instead of `ui/build`.
  </action>
  <verify>docker build -t deep-dive:dev .</verify>
  <done>Docker build completes using the Vite output and the justfile exposes core dev/test commands.</done>
</task>

</tasks>

<verification>
- `npm --prefix ui run lint` and `npm --prefix ui run test -- --run` succeed.
- `docker build -t deep-dive:dev .` succeeds.
</verification>

<success_criteria>
- Local lint/test commands run under Vite tooling.
- Docker build uses the Vite output directory.
</success_criteria>

<output>
After completion, create `.planning/phases/01-platform-ci-baseline/01-02-SUMMARY.md`
</output>
