---
phase: 01-platform-ci-baseline
plan: 03
type: execute
wave: 2
depends_on:
  - "01-02"
files_modified:
  - .github/workflows/ci.yml
autonomous: true
must_haves:
  truths:
    - "Maintainer can build and validate the extension image in Linux CI."
    - "Maintainer can run Go tests/vet as part of CI."
    - "Maintainer can run UI lint/tests and build in CI."
  artifacts:
    - path: ".github/workflows/ci.yml"
      provides: "Linux CI pipeline for build, test, and validate"
  key_links:
    - from: ".github/workflows/ci.yml"
      to: "vm/go.mod"
      via: "setup-go and go test/vet"
      pattern: "go-version-file: vm/go.mod"
    - from: ".github/workflows/ci.yml"
      to: "docker extension validate"
      via: "extension validation step"
      pattern: "docker extension validate"
---

<objective>
Add Linux CI to build, test, and validate the extension.

Purpose: Satisfy PLAT-01 and PLAT-04 via repeatable CI checks.
Output: GitHub Actions workflow that runs UI lint/tests/build, Go test/vet, and extension validation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-platform-ci-baseline/01-RESEARCH.md
@ui/package.json
@vm/go.mod
@Dockerfile
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CI workflow for UI + Go checks</name>
  <files>.github/workflows/ci.yml</files>
  <action>
    - Create `.github/workflows/ci.yml` triggered on push and pull_request to `main`.
    - Install Node 20.19+ with `actions/setup-node`, run `npm ci` in `ui/`, then `npm run lint`, `npm run test -- --run`, and `npm run build`.
    - Install Go using `actions/setup-go` with `go-version-file: vm/go.mod`, run `go test ./...` and `go vet ./...` in `vm/`.
  </action>
  <verify>GitHub Actions run shows UI lint/test/build and Go test/vet steps passing.</verify>
  <done>CI workflow executes UI and Go checks on Linux runners.</done>
</task>

<task type="auto">
  <name>Task 2: Build and validate the extension image in CI</name>
  <files>.github/workflows/ci.yml</files>
  <action>
    - Add Docker build step: `docker build -t deep-dive:ci .`.
    - Install Docker Extensions CLI tooling (from official extensions-sdk release or CLI plugin) and verify `docker extension version` is available.
    - Run `docker extension validate deep-dive:ci` as a required step (no metadata-only fallback).
  </action>
  <verify>GitHub Actions run completes the build + validation step without errors.</verify>
  <done>Extension image validation is enforced in CI.</done>
</task>

</tasks>

<verification>
- CI workflow runs on PRs and main pushes.
- UI lint/test/build, Go test/vet, and docker validate steps succeed.
</verification>

<success_criteria>
- Linux CI verifies build and validation for the extension image.
- Go tests/vet and UI checks are enforced on every PR.
</success_criteria>

<output>
After completion, create `.planning/phases/01-platform-ci-baseline/01-03-SUMMARY.md`
</output>
